<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Anniversary ‚Äî Game Card</title>
  <style>
    :root{
      --bg1:#fde1e3; --bg2:#e7f0ff; --ink:#222; --muted:#6b7280; --accent:#ff4d6d; --accent2:#7c3aed; --card:#ffffffcc;
    }
    html,body{height:100%;}
    body{
      margin:0;font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      color:var(--ink);
      background: radial-gradient(1200px 800px at 15% 10%, #ffe4f0, transparent),
                  radial-gradient(1200px 800px at 85% 10%, #eaf5ff, transparent),
                  radial-gradient(1200px 800px at 50% 100%, #fff5e4, transparent),
                  linear-gradient(135deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .wrapper{max-width:980px;margin:48px auto;padding:0 16px;}
    .card{
      background:var(--card); backdrop-filter: blur(8px);
      border-radius:24px; box-shadow:0 10px 30px rgba(0,0,0,.08);
      padding:28px; position:relative; overflow:hidden;
    }
    h1{
      margin:0 0 8px; font-size: clamp(24px, 4vw, 42px); line-height:1.1;
      letter-spacing:.5px;
    }
    .sub{color:var(--muted); margin-bottom:18px}

    .progress{height:10px;background:#f1f5f9;border-radius:999px;overflow:hidden;}
    .bar{height:100%; width:0; background: linear-gradient(90deg, var(--accent), #ff9aa2, #ffc2d1, var(--accent2));
      transition:width .4s ease;}
    .pill{display:inline-block;background:#f8fafc;border:1px solid #e5e7eb;color:#1f2937;padding:6px 12px;border-radius:999px;font-size:14px}

    .puzzle{display:none;margin-top:18px}
    .puzzle.active{display:block}
    .puzzle h2{font-size: clamp(18px, 2.5vw, 24px); margin:0 0 8px}
    .puzzle .desc{color:var(--muted); margin-bottom:12px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    input[type=text], input[type=number]{padding:10px 12px;border-radius:10px;border:1px solid #e5e7eb;font-size:16px}
    button.btn{cursor:pointer;border:0;padding:10px 16px;border-radius:12px;font-weight:600;box-shadow:0 5px 14px rgba(0,0,0,.08)}
    .btn.primary{background:linear-gradient(90deg, var(--accent), #ff758f); color:white}
    .btn.ghost{background:white;border:1px solid #e5e7eb}
    .ok{color:#16a34a;font-weight:700}
    .bad{color:#dc2626;font-weight:700}

    /* Floating hearts in corners */
    .hearts{position:fixed; inset:0; pointer-events:none;}
    .heart{position:absolute; font-size:18px; opacity:.4; animation: floatUp 12s linear infinite;}
    .heart.big{font-size:28px; opacity:.25}
    .heart.small{font-size:14px; opacity:.5}
    @keyframes floatUp{0%{transform: translateY(0) scale(1)} 100%{transform: translateY(-120vh) scale(1.4)}}

    /* Memory cards */
    .grid4{display:grid;grid-template-columns:repeat(4,64px);gap:10px}
    .cardx{width:64px;height:82px;border-radius:12px;border:1px solid #e5e7eb;background:#fff;display:flex;align-items:center;justify-content:center;font-size:26px;cursor:pointer;box-shadow:0 6px 12px rgba(0,0,0,.06)}
    .cardx.revealed{background:#fff8fb;border-color:#ffc2d1}
    .cardx.matched{background:#dcfce7;border-color:#86efac}

    /* Path grid */
    .grid16{display:grid;grid-template-columns:repeat(4,48px);gap:6px}
    .cell{width:48px;height:48px;border-radius:8px;border:1px solid #e5e7eb;background:#fff;display:flex;align-items:center;justify-content:center;font-size:14px;cursor:pointer;user-select:none}
    .cell.block{background:#f1f5f9;color:#9ca3af;cursor:not-allowed}
    .cell.path{background:#fff7ed;border-color:#fdba74}
    .cell.start{background:#e0f2fe;border-color:#93c5fd}
    .cell.end{background:#dcfce7;border-color:#86efac}

    /* Sliding puzzle */
    .slide{display:grid;grid-template-columns:repeat(3,84px);gap:8px;}
    .tile{width:84px;height:84px;border-radius:12px;border:1px solid #e5e7eb;background:#fff;font-weight:700;font-size:22px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 8px 16px rgba(0,0,0,.06)}
    .tile.blank{background:transparent;border:1px dashed #e5e7eb;cursor:default;box-shadow:none}

    .banner{position:fixed;left:0;right:0;bottom:-80px;background:linear-gradient(90deg,#16a34a,#34d399);color:white;padding:16px 20px;font-weight:700;display:flex;gap:12px;justify-content:center;align-items:center;transition:bottom .5s ease; z-index:50}
    .banner.show{bottom:0}
    .note{font-size:14px;color:#64748b}
  </style>
</head>
<body>
  <!-- Floating hearts (corners) -->
  <div class="hearts" aria-hidden="true" id="hearts"></div>

  <div class="wrapper">
    <div class="card">
      <h1>Happy Anniversary üíñ</h1>
      <div class="sub">Eight brainy mini‚Äëgames. Solve them all to unlock your song surprises.</div>
      <div class="progress" aria-label="progress">
        <div class="bar" id="bar"></div>
      </div>
      <div class="note" id="progressNote" style="margin-top:8px">0 / 8 solved</div>

      <!-- Puzzle 1 -->
      <section class="puzzle active" id="p1">
        <h2>1) Logic Math: Symbols</h2>
        <div class="desc">If üíç = 7 and ‚ù§Ô∏è = 5, evaluate: <strong>üíç + ‚ù§Ô∏è √ó 2</strong></div>
        <div class="row">
          <input id="p1in" type="number" placeholder="Your answer" />
          <button class="btn primary" onclick="check1()">Check</button>
          <span id="p1msg"></span>
        </div>
      </section>

      <!-- Puzzle 2 -->
      <section class="puzzle" id="p2">
        <h2>2) Word Scramble</h2>
        <div class="desc">Unscramble the letters into a love‚Äëday word: <strong>E O L V</strong></div>
        <div class="row">
          <input id="p2in" type="text" placeholder="Type the word"/>
          <button class="btn primary" onclick="check2()">Check</button>
          <span id="p2msg"></span>
        </div>
      </section>

      <!-- Puzzle 3 -->
      <section class="puzzle" id="p3">
        <h2>3) XOR Switches</h2>
        <div class="desc">Set the switches so that <strong>A XOR B = 1</strong>.</div>
        <div class="row" style="gap:20px">
          <label><input type="checkbox" id="a"> A</label>
          <label><input type="checkbox" id="b"> B</label>
          <button class="btn primary" onclick="check3()">Check</button>
          <span id="p3msg"></span>
        </div>
      </section>

      <!-- Puzzle 4 -->
      <section class="puzzle" id="p4">
        <h2>4) Memory Match (2 pairs)</h2>
        <div class="desc">Flip and match the hearts and rings.</div>
        <div class="grid4" id="memGrid"></div>
        <div id="p4msg" style="margin-top:10px"></div>
      </section>

      <!-- Puzzle 5 -->
      <section class="puzzle" id="p5">
        <h2>5) Path Logic</h2>
        <div class="desc">Click a valid path from <strong>Start</strong> to <strong>End</strong> without touching blocked cells.</div>
        <div class="grid16" id="pathGrid" style="margin:10px 0"></div>
        <div id="p5msg"></div>
      </section>

      <!-- Puzzle 6 -->
      <section class="puzzle" id="p6">
        <h2>6) Sequence</h2>
        <div class="desc">3, 9, 27, <strong>?</strong>, 243 ‚Äî choose the missing term.</div>
        <div class="row">
          <label><input type="radio" name="s6" value="54"> 54</label>
          <label><input type="radio" name="s6" value="72"> 72</label>
          <label><input type="radio" name="s6" value="81"> 81</label>
          <button class="btn primary" onclick="check6()">Check</button>
          <span id="p6msg"></span>
        </div>
      </section>

      <!-- Puzzle 7 -->
      <section class="puzzle" id="p7">
        <h2>7) Riddle</h2>
        <div class="desc">‚ÄúI speak without a mouth, and hear without ears. I have no body, but I come alive with wind.‚Äù What am I?</div>
        <div class="row">
          <input id="p7in" type="text" placeholder="Your answer"/>
          <button class="btn primary" onclick="check7()">Check</button>
          <span id="p7msg"></span>
        </div>
      </section>

      <!-- Puzzle 8 -->
      <section class="puzzle" id="p8">
        <h2>8) Sliding Puzzle (3√ó3)</h2>
        <div class="desc">Click tiles next to the blank to arrange 1‚Üí8.</div>
        <div class="slide" id="slide"></div>
        <div class="note" style="margin-top:8px">Tip: solvable layout is pre‚Äëshuffled.</div>
        <div id="p8msg" style="margin-top:10px"></div>
      </section>

      <div style="margin-top:18px" class="note">Games unlock one‚Äëby‚Äëone. Progress saves until reload.</div>
    </div>
  </div>

  <!-- Final banner -->
  <div class="banner" id="finalBanner">üéâ You‚Äôve completed all the problems on this page ‚Äî now enjoy the song!</div>

  <!-- Audio assets (place files alongside index.html) -->
  <audio id="audio5" src="call123.mp3" preload="auto"></audio>
  <audio id="audio8" src="345.mp3" preload="auto"></audio>

  <script>
    // ---------- UTIL & PROGRESS ----------
    const total = 8; let solved = 0; let current = 1;
    const bar = document.getElementById('bar');
    const progressNote = document.getElementById('progressNote');

    function updateProgress(){
      const pct = Math.round((solved/total)*100);
      bar.style.width = pct + '%';
      progressNote.textContent = `${solved} / ${total} solved`;
    }
    function showPuzzle(n){
      document.querySelectorAll('.puzzle').forEach(el=>el.classList.remove('active'));
      const next = document.getElementById('p'+n);
      if(next){ next.classList.add('active'); current = n; }
      updateProgress();
    }
    function markSolved(n){
      if(n===5){ try{ document.getElementById('audio5').play(); }catch(_){} }
      if(n===8){
        const banner = document.getElementById('finalBanner');
        banner.classList.add('show');
        try{ document.getElementById('audio8').play(); }catch(_){}
      }
      solved = Math.max(solved, n);
      updateProgress();
      showPuzzle(n+1);
    }

    // ---------- Hearts animation ----------
    (function hearts(){
      const wrap = document.getElementById('hearts');
      const palette = ['#ff7aa2','#ff9aa2','#ffc2d1','#e0aaff','#cba6f7','#94a3b8'];
      for(let i=0;i<18;i++){
        const s = document.createElement('span');
        s.className = 'heart' + (Math.random()>0.66?' big': Math.random()<0.33?' small':'');
        s.textContent = '‚ù§';
        const left = Math.random()*100; // vw
        const delay = (Math.random()*-12).toFixed(2) + 's';
        const dur = (10 + Math.random()*10).toFixed(1) + 's';
        s.style.left = left + 'vw';
        s.style.bottom = (-10 + Math.random()*40) + 'vh';
        s.style.animationDuration = dur;
        s.style.animationDelay = delay;
        s.style.color = palette[(Math.random()*palette.length)|0];
        wrap.appendChild(s);
      }
    })();

    // ---------- Puzzle 1 ----------
    function check1(){
      const v = Number(document.getElementById('p1in').value);
      const msg = document.getElementById('p1msg');
      if(v===17){ msg.innerHTML = '<span class="ok">Correct!</span>'; markSolved(1);} else { msg.innerHTML = '<span class="bad">Try again</span>'; }
    }

    // ---------- Puzzle 2 ----------
    function check2(){
      const v = (document.getElementById('p2in').value||'').trim().toLowerCase();
      const msg = document.getElementById('p2msg');
      if(v==='love'){ msg.innerHTML = '<span class="ok">Correct!</span>'; markSolved(2);} else { msg.innerHTML = '<span class="bad">Nope</span>'; }
    }

    // ---------- Puzzle 3 ----------
    function check3(){
      const A = document.getElementById('a').checked;
      const B = document.getElementById('b').checked;
      const msg = document.getElementById('p3msg');
      if((A && !B) || (!A && B)){ msg.innerHTML = '<span class="ok">XOR = 1 ‚úî</span>'; markSolved(3);} else { msg.innerHTML = '<span class="bad">XOR ‚â† 1</span>'; }
    }

    // ---------- Puzzle 4 (Memory) ----------
    const memVals = ['üíñ','üíç','üíñ','üíç'];
    let memOpen = []; let memMatched = 0;
    function buildMemory(){
      const grid = document.getElementById('memGrid'); grid.innerHTML = '';
      // deterministic order for simplicity/time
      memVals.forEach((sym,idx)=>{
        const d = document.createElement('button'); d.type='button'; d.className='cardx'; d.dataset.idx=idx; d.textContent='?';
        d.addEventListener('click', ()=> flipMem(d, sym));
        grid.appendChild(d);
      });
    }
    function flipMem(el, sym){
      if(el.classList.contains('matched') || el.classList.contains('revealed')) return;
      if(memOpen.length===2) return;
      el.classList.add('revealed'); el.textContent = sym;
      memOpen.push({el, sym});
      if(memOpen.length===2){
        const [a,b]=memOpen; setTimeout(()=>{
          if(a.sym===b.sym){ a.el.classList.add('matched'); b.el.classList.add('matched'); memMatched+=2; }
          else { a.el.classList.remove('revealed'); b.el.classList.remove('revealed'); a.el.textContent='?'; b.el.textContent='?'; }
          memOpen=[]; if(memMatched===memVals.length){ document.getElementById('p4msg').innerHTML='<span class="ok">All matched!</span>'; markSolved(4);} 
        }, 450);
      }
    }

    // ---------- Puzzle 5 (Path) ----------
    const BLOCKS = new Set(['1,1','1,2','2,1']); // simple obstacles
    const GOAL_PATH = ['0,0','0,1','0,2','0,3','1,3','2,3','3,3'];
    let pathProgress = [];
    function buildPath(){
      const grid = document.getElementById('pathGrid'); grid.innerHTML=''; pathProgress=[];
      for(let r=0;r<4;r++){
        for(let c=0;c<4;c++){
          const btn = document.createElement('button'); btn.type='button'; btn.className='cell'; btn.dataset.rc=`${r},${c}`; btn.textContent='';
          if(BLOCKS.has(`${r},${c}`)){ btn.classList.add('block'); btn.disabled=true; btn.textContent='√ó'; }
          if(r===0&&c===0){ btn.classList.add('start'); btn.textContent='S'; }
          if(r===3&&c===3){ btn.classList.add('end'); btn.textContent='E'; }
          btn.addEventListener('click', ()=>clickPath(btn));
          grid.appendChild(btn);
        }
      }
    }
    function clickPath(btn){
      const rc = btn.dataset.rc;
      const i = pathProgress.length;
      if(rc!==GOAL_PATH[i]){ // wrong
        document.getElementById('p5msg').innerHTML = '<span class="bad">Wrong step ‚Äî path reset.</span>';
        // reset visuals
        pathProgress=[]; document.querySelectorAll('#pathGrid .cell.path').forEach(el=>el.classList.remove('path'));
        return;
      }
      btn.classList.add('path'); pathProgress.push(rc);
      if(pathProgress.length===GOAL_PATH.length){
        document.getElementById('p5msg').innerHTML = '<span class="ok">Path found! üéµ</span>';
        markSolved(5);
      }
    }

    // ---------- Puzzle 6 ----------
    function check6(){
      const v = (document.querySelector('input[name="s6"]:checked')||{}).value;
      const msg = document.getElementById('p6msg');
      if(v==='81'){ msg.innerHTML='<span class="ok">Correct</span>'; markSolved(6);} else { msg.innerHTML='<span class="bad">Nope</span>'; }
    }

    // ---------- Puzzle 7 ----------
    function check7(){
      const v = (document.getElementById('p7in').value||'').trim().toLowerCase();
      const msg = document.getElementById('p7msg');
      if(v==='echo'){ msg.innerHTML='<span class="ok">Correct</span>'; markSolved(7);} else { msg.innerHTML='<span class="bad">Try again</span>'; }
    }

    // ---------- Puzzle 8 (Sliding) ----------
    const slideEl = document.getElementById('slide');
    let board = [1,2,3,4,5,6,7,8,0]; // 0 = blank
    function isNeighbor(i,j){
      const r1=Math.floor(i/3), c1=i%3, r2=Math.floor(j/3), c2=j%3; return Math.abs(r1-r2)+Math.abs(c1-c2)===1;
    }
    function renderBoard(){
      slideEl.innerHTML='';
      board.forEach((v,idx)=>{
        const d = document.createElement('button'); d.type='button'; d.className='tile'+(v===0?' blank':''); d.textContent= v===0? '' : v;
        d.addEventListener('click',()=>move(idx));
        slideEl.appendChild(d);
      });
    }
    function move(idx){
      const z = board.indexOf(0);
      if(isNeighbor(idx,z)){
        [board[idx],board[z]] = [board[z],board[idx]];
        renderBoard();
        if(solvedSlide()){ document.getElementById('p8msg').innerHTML='<span class="ok">Solved! üéâ</span>'; markSolved(8); }
      }
    }
    function solvedSlide(){
      return board.every((v,i)=> v=== (i<8? i+1 : 0));
    }
    function shuffleSolvable(moves=120){
      // random legal moves from solved state ensures solvability
      board = [1,2,3,4,5,6,7,8,0];
      let z = 8;
      for(let k=0;k<moves;k++){
        const nbs = [];
        if(z%3>0) nbs.push(z-1); if(z%3<2) nbs.push(z+1); if(z>=3) nbs.push(z-3); if(z<6) nbs.push(z+3);
        const pick = nbs[(Math.random()*nbs.length)|0];
        [board[z],board[pick]]=[board[pick],board[z]]; z = pick;
      }
      renderBoard();
    }

    // ---------- Boot ----------
    function init(){
      updateProgress();
      buildMemory();
      buildPath();
    }
    init();

    // lazy initialize sliding when section shown
    const observer = new MutationObserver(()=>{
      const active = document.querySelector('.puzzle.active');
      if(active && active.id==='p8' && slideEl.childElementCount===0){ shuffleSolvable(); }
    });
    observer.observe(document.body,{subtree:true, attributes:true, attributeFilter:['class']});
  </script>
</body>
</html>
